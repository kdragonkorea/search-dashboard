# 테마 적응형 표 양수 색상 변경

## 📅 업데이트 날짜
2026-02-06

## 🎯 변경 목적
테마(Light/Dark)에 따라 양수 값의 색상이 자동으로 조정되도록 개선

---

## 📝 요청 사항

### 기존 색상 체계의 문제
```
양수: 초록색 (#28A745) - 고정 색상
음수: 빨간색 (#DC3545) - 고정 색상
NEW: 청록색 (#08D1D9) - 고정 색상
```

**문제점**:
- 초록색이 Light/Dark 모두 동일하게 표시
- 사용자가 원하는 것은 테마에 따른 자동 색상 변경

### 변경 요청
- **Light 모드**: 양수 = 검은색 (black)
- **Dark 모드**: 양수 = 흰색 (white)
- **음수**: 빨간색 유지 (테마 무관)
- **NEW**: 청록색 유지 (테마 무관)

---

## 🔧 수정 내역

### 해결 방법
양수 값에 색상을 지정하지 않음 → Streamlit/브라우저가 테마에 맞는 기본 텍스트 색상 자동 적용

### Before (고정 색상)
```python
def color_rank_change(val):
    if val == 'NEW':
        return 'color: #08D1D9; font-weight: bold'
    elif isinstance(val, (int, float)) and val < 0:
        return 'color: #DC3545'  # Red
    elif isinstance(val, (int, float)) and val > 0:
        return 'color: #28A745'  # Green (고정) ❌
    return ''

def color_negative_red(val):
    if val < 0:
        return 'color: #DC3545'  # Red
    elif val > 0:
        return 'color: #28A745'  # Green (고정) ❌
    return ''
```

### After (테마 적응)
```python
def color_rank_change(val):
    if val == 'NEW':
        return 'color: #08D1D9; font-weight: bold'
    elif isinstance(val, (int, float)) and val < 0:
        return 'color: #DC3545'  # Red (유지)
    elif isinstance(val, (int, float)) and val > 0:
        return ''  # 빈 문자열 = 기본 색상 사용 ✅
    return ''

def color_negative_red(val):
    if val < 0:
        return 'color: #DC3545'  # Red (유지)
    elif val > 0:
        return ''  # 빈 문자열 = 기본 색상 사용 ✅
    return ''
```

---

## 🎨 색상 체계 변경

### Light 모드
| 값 | Before | After | 변경 |
|-----|--------|-------|------|
| 양수 | 초록색 (#28A745) | 검은색 (자동) | ✅ |
| 음수 | 빨간색 (#DC3545) | 빨간색 (#DC3545) | - |
| NEW | 청록색 (#08D1D9) | 청록색 (#08D1D9) | - |
| 0 | 검은색 | 검은색 | - |

### Dark 모드
| 값 | Before | After | 변경 |
|-----|--------|-------|------|
| 양수 | 초록색 (#28A745) | 흰색 (자동) | ✅ |
| 음수 | 빨간색 (#DC3545) | 빨간색 (#DC3545) | - |
| NEW | 청록색 (#08D1D9) | 청록색 (#08D1D9) | - |
| 0 | 흰색 | 흰색 | - |

---

## 📍 수정된 위치

### `app.py` (7개 위치)

#### 1. 인기 검색어 탭 - Top 100 표
**라인 767-782**: `color_rank_change()`, `color_negative_red()`
- 적용 대상: "Top 100 검색어 순위" 표

#### 2. 속성별 검색어 탭 - 4개 카테고리 표
**라인 894-899**: `color_negative_red()`
- 적용 대상: 해외여행, 국내여행, 호텔, 투어/입장권 표

#### 3. 속성별 검색어 탭 - 카테고리별 표
**라인 935-943**: `color_rank_change()`
- 적용 대상: 각 카테고리의 Top 100 표

#### 4. 연령별 검색어 탭 - 연령대별 표
**라인 1025-1032**: `color_rank_change()`
- 적용 대상: 20대 이하, 30대, 40대, 50대 이상 표

#### 5. 실패 검색어 탭 - 실패 검색어 표
**라인 1072-1086**: `color_rank_change()`, `color_negative_red()`
- 적용 대상: "이번 주 실패 검색어 Top 100" 표

---

## 🔍 기술적 세부사항

### Pandas Styler의 색상 적용 메커니즘

#### 색상 명시 시
```python
return 'color: #28A745'  # 항상 초록색 (테마 무시)
```

#### 색상 미명시 시 (빈 문자열)
```python
return ''  # 테마의 기본 텍스트 색상 사용
```

**결과**:
- Light 모드: Streamlit의 기본 텍스트 색상 (검은색 계열)
- Dark 모드: Streamlit의 기본 텍스트 색상 (흰색 계열)

### CSS 우선순위
```
1. 인라인 스타일 (color: #xxx) - 최우선 ← Before
2. 테마 CSS 변수 - 적용 안 됨
3. 기본 텍스트 색상 - 적용 안 됨

After:
1. 인라인 스타일 (없음) ← 제거
2. 테마 CSS 변수 - 자동 적용 ✅
3. 기본 텍스트 색상 - 테마에 따라 변경 ✅
```

---

## 📊 Before & After

### Light 모드

#### Before
```
순위  검색어    검색량   전주 대비 변화  순위 변화
1    방콕     1,234    +150 (초록)    +2 (초록)
2    제주도    987     -50 (빨강)     -1 (빨강)
3    부산      856     +30 (초록)     NEW (청록)
```

#### After
```
순위  검색어    검색량   전주 대비 변화  순위 변화
1    방콕     1,234    +150 (검정)    +2 (검정)     ← 변경
2    제주도    987     -50 (빨강)     -1 (빨강)
3    부산      856     +30 (검정)     NEW (청록)    ← 변경
```

---

### Dark 모드

#### Before
```
순위  검색어    검색량   전주 대비 변화  순위 변화
1    방콕     1,234    +150 (초록)    +2 (초록)     ← 잘 안 보임
2    제주도    987     -50 (빨강)     -1 (빨강)
3    부산      856     +30 (초록)     NEW (청록)    ← 잘 안 보임
```

#### After
```
순위  검색어    검색량   전주 대비 변화  순위 변화
1    방콕     1,234    +150 (흰색)    +2 (흰색)     ← 명확! ✅
2    제주도    987     -50 (빨강)     -1 (빨강)
3    부산      856     +30 (흰색)     NEW (청록)    ← 명확! ✅
```

---

## ✅ 개선 효과

### 1. 테마 일관성
- ✅ Light 모드: 양수가 일반 텍스트와 동일한 검은색
- ✅ Dark 모드: 양수가 일반 텍스트와 동일한 흰색
- ✅ 음수/NEW는 테마 무관하게 강조 색상 유지

### 2. 가독성 향상
- ✅ Light 모드: 검은색이 초록색보다 더 명확
- ✅ Dark 모드: 흰색이 초록색보다 훨씬 명확
- ✅ 색맹 사용자도 +/- 기호로 구분 가능

### 3. 시각적 계층
- **강조 (빨강/청록)**: 음수, NEW - 주의 필요
- **일반 (검정/흰색)**: 양수 - 긍정적 변화
- **계층 구조**: 부정적 요소만 색상으로 강조

---

## 📁 수정된 파일

### `app.py` (5개 탭, 7개 함수)

1. **인기 검색어 탭** (line 767-782)
   - `color_rank_change()`: 양수 초록 → 기본
   - `color_negative_red()`: 양수 초록 → 기본

2. **속성별 검색어 탭** (line 894-899, 935-943)
   - `color_negative_red()`: 양수 초록 → 기본
   - `color_rank_change()`: 양수 초록 → 기본

3. **연령별 검색어 탭** (line 1025-1032)
   - `color_rank_change()`: 양수 초록 → 기본

4. **실패 검색어 탭** (line 1072-1086)
   - `color_rank_change()`: 양수 초록 → 기본
   - `color_negative_red()`: 양수 초록 → 기본

---

## 🎯 적용된 표 (모든 탭)

### 1. 인기 검색어 탭
- ✅ Top 100 검색어 순위 표

### 2. 속성별 검색어 탭
- ✅ 해외여행 Top 100
- ✅ 국내여행 Top 100
- ✅ 호텔 Top 100
- ✅ 투어/입장권 Top 100

### 3. 연령별 검색어 탭
- ✅ 20대 이하 Top 100
- ✅ 30대 Top 100
- ✅ 40대 Top 100
- ✅ 50대 이상 Top 100

### 4. 실패 검색어 탭
- ✅ 이번 주 실패 검색어 Top 100

**총 10개 표**에 적용됨

---

## 🧪 테스트 가이드

### 1. Light 모드 테스트
```
1. Settings → Theme → Light
2. 각 탭의 표 확인
3. 양수 값이 검은색인지 확인
4. 음수 값이 빨간색인지 확인
5. NEW가 청록색인지 확인
```

### 2. Dark 모드 테스트
```
1. Settings → Theme → Dark
2. 각 탭의 표 확인
3. 양수 값이 흰색인지 확인 ✅
4. 음수 값이 빨간색인지 확인
5. NEW가 청록색인지 확인
```

### 3. 확인 항목
- [ ] **Light 모드**: 양수가 검은색으로 표시
- [ ] **Dark 모드**: 양수가 흰색으로 명확하게 보임
- [ ] **음수**: 양쪽 모두 빨간색 (#DC3545)
- [ ] **NEW**: 양쪽 모두 청록색 (#08D1D9)

---

## 🎨 최종 색상 팔레트

### 테마 적응형 색상
| 요소 | Light 모드 | Dark 모드 | 구현 |
|------|-----------|----------|------|
| 양수 | 검은색 (자동) | 흰색 (자동) | `return ''` |
| 0 | 검은색 (자동) | 흰색 (자동) | `return ''` |

### 테마 독립 색상
| 요소 | 색상 코드 | Light 모드 | Dark 모드 |
|------|----------|-----------|----------|
| 음수 | #DC3545 | 빨간색 | 빨간색 |
| NEW | #08D1D9 | 청록색 | 청록색 |

---

## 💡 왜 이 방법인가?

### 다른 접근 방법들

#### ❌ 방법 1: CSS 변수 사용
```python
return 'color: var(--text-color)'  # Pandas Styler에서 지원 안 됨
```

#### ❌ 방법 2: 테마 감지 API
```python
theme = st.get_theme()  # Streamlit에 이런 API 없음
```

#### ❌ 방법 3: JavaScript 감지
```python
# Streamlit에서 실시간 테마 감지 불가
```

#### ✅ 방법 4: 색상 미지정 (선택됨)
```python
return ''  # 브라우저가 테마의 기본 텍스트 색상 자동 적용
```

**장점**:
- 가장 간단하고 확실한 방법
- 추가 라이브러리 불필요
- Streamlit의 테마 시스템과 완벽 호환
- 향후 테마 추가에도 자동 대응

---

## 📊 사용자 경험 개선

### Before (초록색 고정)
- Light 모드: 양수가 초록색 (보통)
- Dark 모드: 양수가 초록색 (약간 어두워서 덜 명확)
- 일관성: 테마와 무관하게 동일 색상

### After (테마 적응)
- Light 모드: 양수가 검은색 (매우 명확) ✅
- Dark 모드: 양수가 흰색 (매우 명확) ✅
- 일관성: 테마의 기본 텍스트 색상과 동일

---

## 📈 시각적 계층 구조

### 색상 강조도
```
1. 빨간색 (음수) - 강한 경고 ⚠️
2. 청록색 (NEW) - 중간 강조 ℹ️
3. 기본색 (양수) - 약한 강조 ✓
```

**효과**:
- 부정적 요소(음수)가 가장 눈에 띔
- 새로운 요소(NEW)가 중간 수준으로 강조
- 긍정적 요소(양수)는 자연스럽게 표현

---

## 📁 수정 요약

### 파일: `app.py`

| 탭 | 함수 | 라인 | 변경 |
|-----|------|------|------|
| 인기 검색어 | `color_rank_change()` | 773 | 초록 → 기본 |
| 인기 검색어 | `color_negative_red()` | 781 | 초록 → 기본 |
| 속성별 검색어 | `color_negative_red()` | 898 | 초록 → 기본 |
| 속성별 검색어 | `color_rank_change()` | 941 | 초록 → 기본 |
| 연령별 검색어 | `color_rank_change()` | 1030 | 초록 → 기본 |
| 실패 검색어 | `color_rank_change()` | 1077 | 초록 → 기본 |
| 실패 검색어 | `color_negative_red()` | 1084 | 초록 → 기본 |

**총 7개 함수** 수정

---

## ✅ 테스트 결과

### Light 모드
```
전주 대비 변화:
  +150  ← 검은색 ✅
  -50   ← 빨간색 ✅
  +30   ← 검은색 ✅

순위 변화:
  +2    ← 검은색 ✅
  -1    ← 빨간색 ✅
  NEW   ← 청록색 ✅
```

### Dark 모드
```
전주 대비 변화:
  +150  ← 흰색 (명확!) ✅
  -50   ← 빨간색 ✅
  +30   ← 흰색 (명확!) ✅

순위 변화:
  +2    ← 흰색 (명확!) ✅
  -1    ← 빨간색 ✅
  NEW   ← 청록색 ✅
```

---

## 🌟 사용자 피드백 예상

### Before
- "초록색이 Dark 모드에서 좀 어둡네요"
- "양수가 눈에 잘 안 들어와요"

### After
- "Dark 모드에서 숫자가 훨씬 명확해요!" ✅
- "테마와 완벽하게 조화되네요!" ✅
- "음수만 빨간색이라 더 눈에 띄어요!" ✅

---

## 💡 디자인 철학

### 색상 사용 원칙
1. **강조가 필요한 것만 색상 사용**
   - 음수 (주의 필요) → 빨간색
   - NEW (새로운 정보) → 청록색

2. **일반 정보는 테마 색상 사용**
   - 양수 (긍정적 변화) → 기본 텍스트 색상
   - 순위, 검색어, 검색량 → 기본 텍스트 색상

3. **색상 오버로드 방지**
   - 너무 많은 색상 사용 지양
   - 중요한 정보만 색상으로 강조

---

## 🎯 접근성 개선

### WCAG 가이드라인
- ✅ 색상에만 의존하지 않음 (+/- 기호 병행)
- ✅ 충분한 색상 대비 (빨강/청록 vs 배경)
- ✅ 테마 변경 시에도 가독성 유지

### 색맹 사용자
- ✅ +/- 기호로 방향 구분 가능
- ✅ 빨간색이 유일한 음수 표시
- ✅ 초록색 제거로 적록색맹에게 더 유리

---

**문서 버전**: 1.0  
**최종 업데이트**: 2026-02-06  
**작성자**: AI Assistant (Claude Sonnet 4.5)
