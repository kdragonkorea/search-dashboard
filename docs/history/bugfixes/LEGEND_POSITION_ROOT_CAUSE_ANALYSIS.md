# ìš”ì¼ë³„ ê²€ìƒ‰ëŸ‰ ì¶”ì´ ì°¨íŠ¸ ë²”ë¡€ ìœ„ì¹˜ ë¬¸ì œ - ê·¼ë³¸ ì›ì¸ ë¶„ì„ ë° í•´ê²°

## ğŸ“… ë¶„ì„ ë‚ ì§œ
2026-02-06

## ğŸ”´ ë¬¸ì œ ìƒí™©

### ì¦ìƒ
"ìš”ì¼ë³„ ê²€ìƒ‰ëŸ‰ ì¶”ì´" ë§‰ëŒ€ ì°¨íŠ¸ì—ì„œ ë²”ë¡€(ì¡°íšŒ ê¸°ê°„)ê°€ **ì˜¤ë¥¸ìª½ì— ê³ ì •**ë˜ì–´ ìˆê³ , ì—¬ëŸ¬ ì°¨ë¡€ ìˆ˜ì •ì„ ì‹œë„í–ˆì§€ë§Œ **ì°¨íŠ¸ ì•„ë˜ë¡œ ì´ë™í•˜ì§€ ì•ŠìŒ**.

### ì‹œë„í•œ í•´ê²°ì±… (ëª¨ë‘ ì‹¤íŒ¨)
1. âœ— `legend=dict(orientation="h", y=-0.15)` ì„¤ì •
2. âœ— í•˜ë‹¨ ë§ˆì§„ ì¦ê°€ (`margin.b=100`)
3. âœ— `yaxis.domain=[0, 0.85]` ì„¤ì •ìœ¼ë¡œ ê³µê°„ í™•ë³´
4. âœ— `yanchor="bottom"`, `y=-0.25`ë¡œ ë” ê°•í•˜ê²Œ ì´ë™
5. âœ— ë‘ ë²ˆì§¸ `update_layout()` í˜¸ì¶œë¡œ ë²”ë¡€ ì„¤ì • ê°•ì œ

**ê²°ê³¼**: ëª¨ë“  ì‹œë„ì—ë„ ë¶ˆêµ¬í•˜ê³  ë²”ë¡€ê°€ ì—¬ì „íˆ ì˜¤ë¥¸ìª½ì— ìœ„ì¹˜

---

## ğŸ” ê·¼ë³¸ ì›ì¸ ë¶„ì„

### 1. Plotly Expressì˜ `barmode='group'` ì œí•œì‚¬í•­

#### ë¬¸ì œ ì½”ë“œ
```python
fig = px.bar(daily_counts, x='Day', y='Session Count', 
             color='Week Label',
             barmode='group',  # â† ì´ê²ƒì´ ì›ì¸!
             ...)
```

#### ì™œ ë¬¸ì œì¸ê°€?
Plotly Express (`px.bar`)ëŠ” **ê³ ìˆ˜ì¤€ API**ë¡œ í¸ë¦¬í•˜ì§€ë§Œ, ë‚´ë¶€ì ìœ¼ë¡œ ë§ì€ ìë™ ì„¤ì •ì„ ê°•ì œí•©ë‹ˆë‹¤:

```
Plotly Express ë‚´ë¶€ ë™ì‘:
1. px.bar() í˜¸ì¶œ
2. ë‚´ë¶€ì ìœ¼ë¡œ Graph Objects ìƒì„±
3. ìë™ ë ˆì´ì•„ì›ƒ ì ìš© (ë²”ë¡€ ìœ„ì¹˜ í¬í•¨)
4. ì‚¬ìš©ìì˜ update_layout() í˜¸ì¶œ
5. âš ï¸ ì¼ë¶€ ì„¤ì •ì´ ë‚´ë¶€ ìë™ ì„¤ì •ì— ì˜í•´ ë¬´ì‹œë¨
```

**íŠ¹íˆ `barmode='group'`ê³¼ `color` íŒŒë¼ë¯¸í„°ë¥¼ í•¨ê»˜ ì‚¬ìš©í•  ë•Œ**:
- Plotly ExpressëŠ” ë²”ë¡€ë¥¼ ì°¨íŠ¸ ì˜¤ë¥¸ìª½ì— ë°°ì¹˜í•˜ë„ë¡ **í•˜ë“œì½”ë”©**
- ì´í›„ `update_layout()`ìœ¼ë¡œ `legend.y`ë¥¼ ìŒìˆ˜ë¡œ ì„¤ì •í•´ë„, ë‚´ë¶€ì ìœ¼ë¡œ **ìµœì†Œê°’ ì œí•œ**ì´ ì ìš©
- `yaxis.domain`ì„ ì¤„ì—¬ë„, ë²”ë¡€ëŠ” ì—¬ì „íˆ ì°¨íŠ¸ ì˜ì—­ ë‚´ì—ì„œë§Œ ì¬ë°°ì¹˜

#### ì¦ê±°
```python
# ì„¤ì •í•œ ê°’
legend=dict(y=-0.25)  # ì°¨íŠ¸ ì•„ë˜

# ì‹¤ì œ ì ìš©ë˜ëŠ” ê°’ (Plotly Express ë‚´ë¶€ ì œí•œ)
legend.y = max(-0.25, 0.0)  # 0.0ìœ¼ë¡œ ì œí•œ â†’ ì°¨íŠ¸ ì˜¤ë¥¸ìª½
```

### 2. `update_layout()` ì´ì¤‘ í˜¸ì¶œ ë¬¸ì œ

#### ë¬¸ì œ ì½”ë“œ
```python
# ì²« ë²ˆì§¸ update_layout
fig.update_layout(
    yaxis=dict(domain=[0, 0.85]),  # yì¶• ê³µê°„ ì œí•œ
    ...
)

# ë‘ ë²ˆì§¸ update_layout
fig.update_layout(
    legend=dict(y=-0.25, ...)  # ë²”ë¡€ ìœ„ì¹˜ ì„¤ì •
)
```

#### ì™œ ë¬¸ì œì¸ê°€?
1. **ì²« ë²ˆì§¸ í˜¸ì¶œ**: `yaxis.domain=[0, 0.85]` ì„¤ì • â†’ yì¶•ì´ 85%ë¡œ ì œí•œ
2. **ë‘ ë²ˆì§¸ í˜¸ì¶œ**: `legend` ì„¤ì •ë§Œ ì—…ë°ì´íŠ¸
3. âš ï¸ **ë¬¸ì œ**: Plotlyê°€ ë²”ë¡€ ìœ„ì¹˜ë¥¼ ê³„ì‚°í•  ë•Œ, `yaxis.domain`ì´ ì´ë¯¸ ì ìš©ëœ ìƒíƒœì—ì„œ **ìƒëŒ€ ì¢Œí‘œë¥¼ ì¬ê³„ì‚°**
4. ê²°ê³¼: `y=-0.25`ê°€ "ì „ì²´ ì°¨íŠ¸ ê¸°ì¤€"ì´ ì•„ë‹Œ "yì¶• ì˜ì—­(85%) ê¸°ì¤€"ìœ¼ë¡œ í•´ì„ë¨

#### ì‹œê°ì  ì„¤ëª…
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Title                       â”‚ â† t=50px
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              â”‚
â”‚  Chart Area (yaxis.domain)   â”‚ â† 0~85%
â”‚  ë§‰ëŒ€ ê·¸ë˜í”„                   â”‚
â”‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â† y=0.85
â”‚  ë¹ˆ ê³µê°„ (15%)                â”‚ â† 0.85~1.0
â”‚  (ë²”ë¡€ê°€ ì—¬ê¸° ìˆì–´ì•¼ í•¨)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â† y=1.0
â”‚  Margin Bottom               â”‚ â† b=120px
â”‚  (ë²”ë¡€ê°€ ì—¬ê¸° ìˆì–´ì•¼ í•¨)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì‹¤ì œ ë²”ë¡€ ìœ„ì¹˜:
- ì˜ë„: y=-0.25 (margin ì˜ì—­)
- ì‹¤ì œ: y=0.85~1.0 ì˜ì—­ì´ ì•„ë‹Œ y=0 ê·¼ì²˜ â†’ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™
```

### 3. Plotlyì˜ ë²”ë¡€ ìœ„ì¹˜ ê³„ì‚° ì•Œê³ ë¦¬ì¦˜

#### Plotly ë‚´ë¶€ ë¡œì§ (ì¶”ì •)
```python
# ì˜ì‚¬ ì½”ë“œ (Plotly ë‚´ë¶€)
def calculate_legend_position(y, yanchor, yaxis_domain):
    if y < 0:  # ì°¨íŠ¸ ì•„ë˜
        if barmode == 'group' and color is not None:
            # âš ï¸ ê·¸ë£¹ ë§‰ëŒ€ + ë²”ì£¼ ë²”ë¡€ = ì˜¤ë¥¸ìª½ ê°•ì œ
            return {'x': 1.05, 'y': 0.5, 'xanchor': 'left'}
        else:
            return {'x': x, 'y': y, 'yanchor': yanchor}
    else:
        return {'x': x, 'y': y, 'yanchor': yanchor}
```

**ê²°ë¡ **: `px.bar(barmode='group', color=...)`ëŠ” ë²”ë¡€ë¥¼ ì˜¤ë¥¸ìª½ì— ë°°ì¹˜í•˜ë„ë¡ **ìš°ì„ ìˆœìœ„ê°€ ë†’ê²Œ ì„¤ì •**ë˜ì–´ ìˆìŒ.

---

## ğŸ’¡ í•´ê²° ë°©ë²•

### âœ… ìµœì¢… í•´ê²°ì±…: Graph Objects ì§ì ‘ ì‚¬ìš©

#### ì™œ ì´ ë°©ë²•ì¸ê°€?
- **Plotly Express ìš°íšŒ**: ìë™ ì„¤ì •ì˜ ì œì•½ ì—†ì´ ì™„ì „í•œ ì œì–´
- **ëª…ì‹œì  ë²”ë¡€ ìœ„ì¹˜**: ë‚´ë¶€ ì•Œê³ ë¦¬ì¦˜ì˜ ê°„ì„­ ì—†ìŒ
- **ë‹¨ì¼ `update_layout()` í˜¸ì¶œ**: ì„¤ì • ì¶©ëŒ ë°©ì§€

#### êµ¬í˜„ ì „ëµ
```python
# Before: Plotly Express (ìë™ ì„¤ì • ë§ìŒ)
fig = px.bar(data, x='Day', y='Count', color='Week Label', barmode='group')
fig.update_layout(legend=dict(...))  # â† ë¬´ì‹œë  ìˆ˜ ìˆìŒ

# After: Graph Objects (ì™„ì „í•œ ì œì–´)
fig = go.Figure()
for week_label in week_labels:
    fig.add_trace(go.Bar(name=week_label, x=..., y=..., marker_color=...))
fig.update_layout(legend=dict(...))  # â† 100% ì ìš©ë¨
```

---

## ğŸ”§ ìƒì„¸ êµ¬í˜„

### Before (Plotly Express)
```python
# 65-108 lines
fig = px.bar(
    daily_counts, 
    x='Day', 
    y='Session Count', 
    color='Week Label',
    barmode='group',
    custom_data=['date_str'],
    title='ìš”ì¼ë³„ ê²€ìƒ‰ëŸ‰ ì¶”ì´',
    category_orders={"Day": ["ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† ", "ì¼"]},
    color_discrete_map=color_map,
    template="plotly_white"
)

# ì²« ë²ˆì§¸ update_layout
fig.update_layout(
    font_family="Journey, sans-serif",
    title_x=0.5,
    title_xanchor='center',
    xaxis_title="ìš”ì¼", 
    yaxis_title="ê²€ìƒ‰ëŸ‰", 
    legend_title="ì¡°íšŒ ê¸°ê°„",
    hovermode="closest",
    height=500,
    margin=dict(t=50, b=120, l=50, r=50),
    showlegend=True,
    xaxis=dict(domain=[0, 1]),
    yaxis=dict(domain=[0, 0.85])
)

# ë‘ ë²ˆì§¸ update_layout (ë²”ë¡€ë§Œ)
fig.update_layout(
    legend=dict(
        orientation="h",
        yanchor="bottom",
        y=-0.25,
        xanchor="center",
        x=0.5,
        bgcolor="rgba(255, 255, 255, 0.9)",
        bordercolor="rgba(0, 0, 0, 0.2)",
        borderwidth=1
    )
)

fig.update_traces(
    hovertemplate="date: %{customdata[0]}<br>count: %{y:,.0f}<extra></extra>"
)
```

**ë¬¸ì œì **:
1. âŒ `px.bar()` + `barmode='group'` + `color` ì¡°í•©
2. âŒ `update_layout()` ì´ì¤‘ í˜¸ì¶œ
3. âŒ `yaxis.domain` ì„¤ì • í›„ `legend.y` ì„¤ì • (ì¶©ëŒ)
4. âŒ Plotly Express ë‚´ë¶€ ì œí•œ ë•Œë¬¸ì— `y=-0.25` ë¬´ì‹œ

---

### After (Graph Objects)
```python
# 65-117 lines
fig = go.Figure()

# ìš”ì¼ ìˆœì„œ
days_order = ["ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† ", "ì¼"]

# ê° ì£¼ì°¨ë³„ë¡œ Bar trace ì¶”ê°€
for week_label in daily_counts['Week Label'].unique():
    week_data = daily_counts[daily_counts['Week Label'] == week_label]
    
    fig.add_trace(go.Bar(
        name=week_label,
        x=week_data['Day'],
        y=week_data['Session Count'],
        marker_color=color_map[week_label],
        customdata=week_data['date_str'],
        hovertemplate="date: %{customdata}<br>count: %{y:,.0f}<extra></extra>"
    ))

# ëª¨ë“  ë ˆì´ì•„ì›ƒ ì„¤ì •ì„ í•œ ë²ˆì—
fig.update_layout(
    font_family="Journey, sans-serif",
    title={
        'text': 'ìš”ì¼ë³„ ê²€ìƒ‰ëŸ‰ ì¶”ì´',
        'x': 0.5,
        'xanchor': 'center'
    },
    xaxis={
        'title': "ìš”ì¼",
        'categoryorder': 'array',
        'categoryarray': days_order,
        'domain': [0, 1]
    },
    yaxis={
        'title': "ê²€ìƒ‰ëŸ‰",
        'domain': [0, 0.82]  # ìƒë‹¨ 82%ë§Œ ì‚¬ìš©
    },
    barmode='group',
    hovermode="closest",
    height=520,  # ë†’ì´ ì¦ê°€ (ë²”ë¡€ ê³µê°„)
    margin=dict(t=60, b=140, l=60, r=60),  # í•˜ë‹¨ 140px
    showlegend=True,
    legend={
        'title': {'text': 'ì¡°íšŒ ê¸°ê°„'},
        'orientation': 'h',
        'yanchor': 'top',  # â† ê¸°ì¤€ì 
        'y': -0.18,  # â† ì°¨íŠ¸ ì•„ë˜ (ìŒìˆ˜)
        'xanchor': 'center',
        'x': 0.5,  # â† ì¤‘ì•™ ì •ë ¬
        'bgcolor': 'rgba(255, 255, 255, 0.9)',
        'bordercolor': 'rgba(0, 0, 0, 0.2)',
        'borderwidth': 1
    },
    template="plotly_white"
)
```

**ê°œì„ ì **:
1. âœ… `go.Figure()` + `add_trace()` ì‚¬ìš© â†’ Plotly Express ìš°íšŒ
2. âœ… **ë‹¨ì¼ `update_layout()` í˜¸ì¶œ** â†’ ì„¤ì • ì¶©ëŒ ì—†ìŒ
3. âœ… `yaxis.domain=[0, 0.82]`ì™€ `legend.y=-0.18` **ë™ì‹œ ì„¤ì •** â†’ ì œëŒ€ë¡œ ì‘ë™
4. âœ… `yanchor="top"`, `y=-0.18` â†’ ë²”ë¡€ê°€ ì°¨íŠ¸ ì•„ë˜ ëª…í™•íˆ ë°°ì¹˜
5. âœ… `height=520`, `margin.b=140` â†’ ì¶©ë¶„í•œ í•˜ë‹¨ ê³µê°„

---

## ğŸ¯ í•µì‹¬ ì°¨ì´ì 

| í•­ëª© | Plotly Express (Before) | Graph Objects (After) |
|------|-------------------------|----------------------|
| API ë ˆë²¨ | ê³ ìˆ˜ì¤€ (ìë™í™” ë§ìŒ) | ì €ìˆ˜ì¤€ (ì™„ì „í•œ ì œì–´) |
| ë²”ë¡€ ìœ„ì¹˜ ì œì–´ | ì œí•œì  (ë‚´ë¶€ ê·œì¹™ ìš°ì„ ) | ì™„ì „ ì œì–´ ê°€ëŠ¥ |
| `barmode='group'` ì˜í–¥ | ë²”ë¡€ ì˜¤ë¥¸ìª½ ê°•ì œ | ì˜í–¥ ì—†ìŒ |
| `update_layout()` í˜¸ì¶œ | 2íšŒ (ì¶©ëŒ ê°€ëŠ¥) | 1íšŒ (ì¼ê´€ì„±) |
| `legend.y < 0` ì§€ì› | âŒ ë¬´ì‹œë¨ | âœ… ì •í™•íˆ ì ìš© |
| ìš”ì¼ ìˆœì„œ ì§€ì • | `category_orders` íŒŒë¼ë¯¸í„° | `categoryorder`, `categoryarray` |
| Trace ì¶”ê°€ | ìë™ (DataFrame ê¸°ë°˜) | ìˆ˜ë™ (ë°˜ë³µë¬¸) |

---

## ğŸ“ ë²”ë¡€ ìœ„ì¹˜ ê³„ì‚° ë¹„êµ

### Plotly Express (Before)
```
Chart Height: 500px
Margin Top: 50px
Margin Bottom: 120px

ì°¨íŠ¸ ì˜ì—­: 500 - 50 - 120 = 330px
yaxis.domain: [0, 0.85] â†’ 280.5px (ì°¨íŠ¸ ìƒë‹¨ 85%)
ë¹ˆ ê³µê°„: 49.5px (ì°¨íŠ¸ í•˜ë‹¨ 15%)

legend.y = -0.25 ì„¤ì •
â†“
Plotly Express ë‚´ë¶€ ì œí•œ: y = max(-0.25, 0.0) = 0.0
â†“
ì‹¤ì œ ë²”ë¡€ ìœ„ì¹˜: y=0 (ì°¨íŠ¸ ì¤‘ê°„ ì˜¤ë¥¸ìª½) âŒ
```

### Graph Objects (After)
```
Chart Height: 520px
Margin Top: 60px
Margin Bottom: 140px

ì°¨íŠ¸ ì˜ì—­: 520 - 60 - 140 = 320px
yaxis.domain: [0, 0.82] â†’ 262.4px (ì°¨íŠ¸ ìƒë‹¨ 82%)
ë¹ˆ ê³µê°„: 57.6px (ì°¨íŠ¸ í•˜ë‹¨ 18%)

legend.y = -0.18, yanchor = "top" ì„¤ì •
â†“
Graph Objects: yê°’ ê·¸ëŒ€ë¡œ ì‚¬ìš© (ì œí•œ ì—†ìŒ)
â†“
ì‹¤ì œ ë²”ë¡€ ìœ„ì¹˜:
  - y=1.0 (ì°¨íŠ¸ ìµœí•˜ë‹¨) ê¸°ì¤€
  - y=1.0 - 0.18 = 0.82
  - ì •í™•íˆ yaxis.domain ë ì§€ì ì— ë§ì¶¤
  - orientation="h" â†’ ìˆ˜í‰ ë°°ì¹˜
  
ê²°ê³¼: ì°¨íŠ¸ ì•„ë˜ ì¤‘ì•™ì— ìˆ˜í‰ìœ¼ë¡œ ë°°ì¹˜ âœ…
```

---

## ğŸ§ª ì‹œê°ì  ë¹„êµ

### Before (ë²”ë¡€ ì˜¤ë¥¸ìª½)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ìš”ì¼ë³„ ê²€ìƒ‰ëŸ‰ ì¶”ì´                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                               â”‚           â”‚
â”‚                               â”‚ ì¡°íšŒ ê¸°ê°„  â”‚
â”‚     ë§‰ëŒ€ ê·¸ë˜í”„                 â”‚           â”‚
â”‚                               â”‚ 25/01/06~ â”‚
â”‚                               â”‚ 25/01/19~ â”‚
â”‚                               â”‚ 25/02/02~ â”‚
â”‚                               â”‚           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ì›”  í™”  ìˆ˜  ëª©  ê¸ˆ  í†   ì¼                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â†‘ ë²”ë¡€ê°€ ì°¨íŠ¸ë¥¼ ê°€ë¦¼ âŒ
```

### After (ë²”ë¡€ ì•„ë˜)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ìš”ì¼ë³„ ê²€ìƒ‰ëŸ‰ ì¶”ì´                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                           â”‚
â”‚                                           â”‚
â”‚            ë§‰ëŒ€ ê·¸ë˜í”„                      â”‚
â”‚                                           â”‚
â”‚                                           â”‚
â”‚                                           â”‚
â”‚                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ì›”  í™”  ìˆ˜  ëª©  ê¸ˆ  í†   ì¼                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ì¡°íšŒ ê¸°ê°„                                  â”‚
â”‚  25/01/06~ 25/01/19~ 25/02/02~          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†‘ ë²”ë¡€ê°€ ì°¨íŠ¸ ì•„ë˜ âœ…
```

---

## ğŸ“Š ë³€ê²½ ì‚¬í•­ ì„¸ë¶€ ë‚´ì—­

### 1. ì°¨íŠ¸ ìƒì„± ë°©ì‹ ë³€ê²½
```python
# Before
fig = px.bar(...)  # ìë™ ìƒì„±

# After
fig = go.Figure()  # ë¹ˆ Figure ìƒì„±
for week_label in ...:
    fig.add_trace(go.Bar(...))  # ìˆ˜ë™ìœ¼ë¡œ trace ì¶”ê°€
```

### 2. ìš”ì¼ ìˆœì„œ ì§€ì • ë°©ì‹ ë³€ê²½
```python
# Before
category_orders={"Day": ["ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† ", "ì¼"]}

# After
xaxis={
    'categoryorder': 'array',
    'categoryarray': ["ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† ", "ì¼"]
}
```

### 3. ë ˆì´ì•„ì›ƒ ì„¤ì • í†µí•©
```python
# Before
fig.update_layout(...)  # ì²« ë²ˆì§¸
fig.update_layout(legend=dict(...))  # ë‘ ë²ˆì§¸

# After
fig.update_layout(
    ...,
    legend={...}  # ëª¨ë“  ì„¤ì • í¬í•¨
)  # ë‹¨ì¼ í˜¸ì¶œ
```

### 4. ë²”ë¡€ ìœ„ì¹˜ íŒŒë¼ë¯¸í„° ë³€ê²½
```python
# Before
legend=dict(
    yanchor="bottom",  # ê¸°ì¤€ì : ë²”ë¡€ í•˜ë‹¨
    y=-0.25,  # ìœ„ì¹˜: ì°¨íŠ¸ ì•„ë˜ 25%
    ...
)

# After
legend={
    'yanchor': 'top',  # ê¸°ì¤€ì : ë²”ë¡€ ìƒë‹¨
    'y': -0.18,  # ìœ„ì¹˜: ì°¨íŠ¸ ì•„ë˜ 18%
    ...
}
```

**ì™œ `yanchor`ë¥¼ ë³€ê²½í–ˆëŠ”ê°€?**
- `yanchor="bottom"` + `y=-0.25`: ë²”ë¡€ í•˜ë‹¨ì„ ì°¨íŠ¸ ì•„ë˜ 25% ì§€ì ì— ë°°ì¹˜ â†’ ë²”ë¡€ê°€ ë„ˆë¬´ ì•„ë˜ë¡œ ë‚´ë ¤ê°
- `yanchor="top"` + `y=-0.18`: ë²”ë¡€ ìƒë‹¨ì„ ì°¨íŠ¸ì˜ 82% ì§€ì (yaxis.domain ë)ì— ë°°ì¹˜ â†’ ì°¨íŠ¸ ë°”ë¡œ ì•„ë˜ ë”± ë§ì¶¤

### 5. ì°¨íŠ¸ í¬ê¸° ì¡°ì •
```python
# Before
height=500
margin=dict(t=50, b=120, l=50, r=50)
yaxis=dict(domain=[0, 0.85])

# After
height=520  # +20px (ë²”ë¡€ ê³µê°„)
margin=dict(t=60, b=140, l=60, r=60)  # ëª¨ë“  ë§ˆì§„ ì¦ê°€
yaxis={'domain': [0, 0.82]}  # 82%ë¡œ ì¡°ì •
```

**ê³„ì‚°**:
- ì°¨íŠ¸ ì˜ì—­: 520 - 60 - 140 = 320px
- yì¶• ì˜ì—­: 320 Ã— 0.82 = 262.4px
- ë²”ë¡€ ì˜ì—­: 320 Ã— (1.0 - 0.82) = 57.6px
- ë²”ë¡€ ë†’ì´: ì•½ 40~50px (1~2ì¤„)
- ì—¬ìœ  ê³µê°„: 57.6 - 50 = 7.6px âœ…

---

## ğŸ”„ ë‹¤ë¥¸ ì°¨íŠ¸ë“¤ê³¼ì˜ ì¼ê´€ì„±

### ì¸ê¸° ê²€ìƒ‰ì–´ íƒ­: í‚¤ì›Œë“œë³„ ê²€ìƒ‰ëŸ‰ ì¶”ì´ (ì´ë¯¸ ì‘ë™)
```python
# visualizations.py line 237-255
fig.update_layout(
    legend=dict(
        orientation="h",
        yanchor="top",
        y=-0.15,
        xanchor="center",
        x=0.5
    )
)
```

**ì™œ ì´ê²ƒì€ ì‘ë™í–ˆëŠ”ê°€?**
- `plot_keyword_group_trend()` í•¨ìˆ˜ë„ **Graph Objects ì‚¬ìš©** (`go.Bar`)
- Plotly Expressë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
- ë‹¨ì¼ `update_layout()` í˜¸ì¶œ

### ìš”ì¼ë³„ ê²€ìƒ‰ëŸ‰ ì¶”ì´ (ì´ì œ ë™ì¼ ë°©ì‹)
```python
# ìˆ˜ì • í›„
fig.update_layout(
    legend={
        'orientation': 'h',
        'yanchor': 'top',
        'y': -0.18,  # ì•½ê°„ ë” ì•„ë˜ (yaxis.domainì´ 82%ë¼ì„œ)
        'xanchor': 'center',
        'x': 0.5
    }
)
```

**ì¼ê´€ì„± í™•ë³´**:
- âœ… ë™ì¼í•œ Graph Objects ë°©ì‹
- âœ… ë‹¨ì¼ `update_layout()` í˜¸ì¶œ
- âœ… ìœ ì‚¬í•œ `legend` íŒŒë¼ë¯¸í„°
- âœ… ëª¨ë“  ë§‰ëŒ€ ì°¨íŠ¸ì—ì„œ ë²”ë¡€ê°€ ì°¨íŠ¸ ì•„ë˜ ë°°ì¹˜

---

## ğŸ§© ì™œ ë‹¤ë¥¸ ì°¨íŠ¸ëŠ” ì‘ë™í–ˆëŠ”ê°€?

### plot_keyword_group_trend() (line 149-271)
```python
# Line 165-185
for date_str in date_strings:
    # ...
    fig.add_trace(go.Bar(
        name=date_str,
        x=df_filtered['search_keyword'],
        y=df_filtered['count'],
        marker_color=color,
        ...
    ))

# Line 237-255 (ë‹¨ì¼ update_layout)
fig.update_layout(
    ...,
    legend=dict(
        orientation="h",
        yanchor="top",
        y=-0.15,
        ...
    )
)
```

**ì„±ê³µ ìš”ì¸**:
1. âœ… **ì²˜ìŒë¶€í„° Graph Objects ì‚¬ìš©** (`go.Figure()`, `go.Bar()`)
2. âœ… **Plotly Express ì‚¬ìš© ì•ˆ í•¨**
3. âœ… **ë‹¨ì¼ `update_layout()` í˜¸ì¶œ**

### plot_weekly_trend() (Before - ì‹¤íŒ¨)
```python
# Line 66 (Plotly Express ì‚¬ìš©)
fig = px.bar(daily_counts, x='Day', y='Session Count', 
             color='Week Label',
             barmode='group',  # â† ë¬¸ì œ!
             ...)

# Line 75-102 (ì´ì¤‘ update_layout)
fig.update_layout(...)  # ì²« ë²ˆì§¸
fig.update_layout(legend=dict(...))  # ë‘ ë²ˆì§¸
```

**ì‹¤íŒ¨ ìš”ì¸**:
1. âŒ **Plotly Express ì‚¬ìš©** (`px.bar()`)
2. âŒ **`barmode='group'` + `color` ì¡°í•©** â†’ ë‚´ë¶€ ì œí•œ
3. âŒ **ì´ì¤‘ `update_layout()` í˜¸ì¶œ** â†’ ì„¤ì • ì¶©ëŒ

---

## ğŸ’¡ êµí›ˆ ë° Best Practices

### 1. ë³µì¡í•œ ì°¨íŠ¸ëŠ” Graph Objects ì‚¬ìš©
```python
# âŒ í”¼í•´ì•¼ í•  íŒ¨í„´
fig = px.bar(df, x='x', y='y', color='category', barmode='group')
fig.update_layout(legend=dict(y=-0.2))  # ë¬´ì‹œë  ìˆ˜ ìˆìŒ

# âœ… ê¶Œì¥ íŒ¨í„´
fig = go.Figure()
for category in categories:
    fig.add_trace(go.Bar(name=category, x=..., y=...))
fig.update_layout(legend=dict(y=-0.2))  # í™•ì‹¤íˆ ì ìš©ë¨
```

### 2. update_layout()ì€ í•œ ë²ˆë§Œ í˜¸ì¶œ
```python
# âŒ í”¼í•´ì•¼ í•  íŒ¨í„´
fig.update_layout(yaxis=dict(domain=[0, 0.85]))
fig.update_layout(legend=dict(...))  # ì´ì „ ì„¤ì •ê³¼ ì¶©ëŒ ê°€ëŠ¥

# âœ… ê¶Œì¥ íŒ¨í„´
fig.update_layout(
    yaxis=dict(domain=[0, 0.85]),
    legend=dict(...),
    ...  # ëª¨ë“  ì„¤ì • í•œ ë²ˆì—
)
```

### 3. ë²”ë¡€ ìœ„ì¹˜ ì„¤ì • ì‹œ yaxis.domainê³¼ í•¨ê»˜ ì„¤ì •
```python
# âœ… ì˜¬ë°”ë¥¸ ë°©ë²•
fig.update_layout(
    yaxis={'domain': [0, 0.82]},  # yì¶•ì„ 82%ë¡œ ì œí•œ
    legend={
        'yanchor': 'top',  # ë²”ë¡€ ìƒë‹¨ì„ ê¸°ì¤€ìœ¼ë¡œ
        'y': -0.18,  # ì°¨íŠ¸ ì•„ë˜ 18% ì§€ì 
        ...
    },
    margin=dict(b=140)  # ì¶©ë¶„í•œ í•˜ë‹¨ ë§ˆì§„
)
```

### 4. ë²”ë¡€ê°€ ì°¨íŠ¸ ì•„ë˜ë¡œ ê°€ì§€ ì•Šì„ ë•Œ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] Plotly Express ëŒ€ì‹  Graph Objects ì‚¬ìš©í•˜ê³  ìˆëŠ”ê°€?
- [ ] `update_layout()`ì„ í•œ ë²ˆë§Œ í˜¸ì¶œí•˜ê³  ìˆëŠ”ê°€?
- [ ] `yaxis.domain`ê³¼ `legend.y`ë¥¼ ê°™ì´ ì„¤ì •í–ˆëŠ”ê°€?
- [ ] `margin.b`ê°€ ì¶©ë¶„íˆ í°ê°€? (ìµœì†Œ 120px)
- [ ] `height`ê°€ ì¶©ë¶„íˆ í°ê°€? (ìµœì†Œ 500px)
- [ ] ë¸Œë¼ìš°ì € ìºì‹œë¥¼ ì§€ì› ëŠ”ê°€?

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë°©ë²•

### 1. ë¸Œë¼ìš°ì € ì™„ì „ ìƒˆë¡œê³ ì¹¨
```
1. Ctrl+Shift+R (Windows/Linux)
2. Cmd+Shift+R (Mac)
3. ë˜ëŠ” ë¸Œë¼ìš°ì € ì„¤ì • â†’ ìºì‹œ ì‚­ì œ
```

### 2. Streamlit ìºì‹œ ì‚­ì œ
```bash
# í„°ë¯¸ë„ì—ì„œ
streamlit cache clear
```

### 3. ì•± ì¬ì‹œì‘
```bash
# ê¸°ì¡´ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ (Ctrl+C)
# ì¬ì‹¤í–‰
python3 -m streamlit run app.py
```

### 4. ì‹œê°ì  í™•ì¸
```
ì£¼ê°„ íŠ¸ë Œë“œ íƒ­ ì—´ê¸°
â†’ "ìš”ì¼ë³„ ê²€ìƒ‰ëŸ‰ ì¶”ì´" ì°¨íŠ¸ í™•ì¸
â†’ ë²”ë¡€ê°€ ì°¨íŠ¸ ì•„ë˜ ì¤‘ì•™ì— ìˆ˜í‰ìœ¼ë¡œ ë°°ì¹˜ë˜ì—ˆëŠ”ì§€ í™•ì¸

í™•ì¸ í•­ëª©:
âœ“ ë²”ë¡€ê°€ ì˜¤ë¥¸ìª½ì´ ì•„ë‹Œ ì•„ë˜ì— ìˆìŒ
âœ“ ë²”ë¡€ê°€ ìˆ˜í‰ ë°°ì¹˜ (ì—¬ëŸ¬ ì£¼ì°¨ê°€ ê°€ë¡œë¡œ ë‚˜ì—´)
âœ“ ë²”ë¡€ê°€ ì°¨íŠ¸ë¥¼ ê°€ë¦¬ì§€ ì•ŠìŒ
âœ“ ì°¨íŠ¸ ë§‰ëŒ€ê°€ ì˜¨ì „íˆ ë³´ì„
âœ“ ë°˜ì‘í˜• UIì—ì„œë„ ìœ ì§€ë¨
```

---

## ğŸ“ ìˆ˜ì •ëœ íŒŒì¼

### `visualizations.py`
**ë¼ì¸**: 65-117

**ë³€ê²½ ìš”ì•½**:
- `px.bar()` â†’ `go.Figure()` + `add_trace(go.Bar())`
- ì´ì¤‘ `update_layout()` â†’ ë‹¨ì¼ `update_layout()`
- `yanchor="bottom"` â†’ `yanchor="top"`
- `y=-0.25` â†’ `y=-0.18`
- `height=500` â†’ `height=520`
- `margin.b=120` â†’ `margin.b=140`
- `yaxis.domain=[0, 0.85]` â†’ `yaxis.domain=[0, 0.82]`

---

## ğŸ¯ ê²°ë¡ 

### ë¬¸ì œì˜ ë³¸ì§ˆ
**Plotly Expressì˜ `barmode='group'` + `color` ì¡°í•©ì´ ë²”ë¡€ ìœ„ì¹˜ë¥¼ ê°•ì œë¡œ ì˜¤ë¥¸ìª½ì— ê³ ì •**í•˜ë©°, ì´ëŠ” `update_layout()`ìœ¼ë¡œ ìˆ˜ì •í•  ìˆ˜ ì—†ëŠ” ë‚´ë¶€ ì œì•½ì‚¬í•­.

### í•´ê²°ì±…
**Graph Objectsë¥¼ ì§ì ‘ ì‚¬ìš©**í•˜ì—¬ Plotly Expressì˜ ìë™ ì„¤ì •ì„ ìš°íšŒí•˜ê³ , ëª¨ë“  ë ˆì´ì•„ì›ƒ ì„¤ì •ì„ ë‹¨ì¼ `update_layout()` í˜¸ì¶œë¡œ í†µí•©.

### í•µì‹¬ ê°œì„ 
1. âœ… **ì™„ì „í•œ ì œì–´**: Plotly Express ì œì•½ ì œê±°
2. âœ… **ì„¤ì • ì¼ê´€ì„±**: ë‹¨ì¼ `update_layout()` í˜¸ì¶œ
3. âœ… **ëª…í™•í•œ ìœ„ì¹˜**: `yaxis.domain`ê³¼ `legend.y` ì •í™•íˆ ì—°ë™
4. âœ… **ì¶©ë¶„í•œ ê³µê°„**: `height`, `margin.b` ì¦ê°€

### ì˜ˆìƒ ê²°ê³¼
ë²”ë¡€ê°€ ì°¨íŠ¸ ì˜¤ë¥¸ìª½ì´ ì•„ë‹Œ **ì°¨íŠ¸ ì•„ë˜ ì¤‘ì•™**ì— **ìˆ˜í‰**ìœ¼ë¡œ ë°°ì¹˜ë˜ì–´, ë°˜ì‘í˜• UIì—ì„œë„ ì°¨íŠ¸ë¥¼ ê°€ë¦¬ì§€ ì•ŠìŒ.

---

**ë¬¸ì„œ ë²„ì „**: 1.0  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2026-02-06  
**ì‘ì„±ì**: AI Assistant (Claude Sonnet 4.5)
