# ë²„ê·¸ ìˆ˜ì •: ì„ í˜• ì°¨íŠ¸ ë°ì´í„° ë¯¸í‘œì‹œ ë¬¸ì œ

## ğŸ› ë¬¸ì œ ìƒí™©

**ì¦ìƒ**: 'ì£¼ê°„ íŠ¸ë Œë“œ' íƒ­ì—ì„œ ì„ í˜• ë¼ë””ì˜¤ ë²„íŠ¼ í´ë¦­ ì‹œ "ì‹œê°í™”í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤." ë©”ì‹œì§€ í‘œì‹œ

**ë°œìƒ ì‹œì **: ì ‘ì† ê²½ë¡œ í•„í„° ìµœì í™” (v6) ì ìš© í›„

## ğŸ” ì›ì¸ ë¶„ì„

### ë¬¸ì œì˜ ê·¼ë³¸ ì›ì¸

ì ‘ì† ê²½ë¡œ í•„í„° ìµœì í™”ë¥¼ ìœ„í•´ 2ê°œì˜ ìºì‹œë¥¼ ë„ì…í–ˆìŠµë‹ˆë‹¤:
- `cached_base_df`: ë‚ ì§œ í•„í„°ë§ë§Œ ì ìš©ëœ ì›ë³¸ ë°ì´í„°
- `cached_filtered_df`: ì ‘ì† ê²½ë¡œ í•„í„°ê¹Œì§€ ì ìš©ëœ ìµœì¢… ë°ì´í„°

í•˜ì§€ë§Œ ì°¨íŠ¸ ë Œë”ë§ í•¨ìˆ˜ë“¤ì´ ì—¬ì „íˆ `cached_trend_df` (êµ¬ ë³€ìˆ˜ëª…) ë˜ëŠ” `cached_base_df`ë¥¼ ì°¸ì¡°í•˜ê³  ìˆì–´, **ì ‘ì† ê²½ë¡œ í•„í„°ê°€ ì ìš©ë˜ì§€ ì•Šì€ ë°ì´í„°**ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.

### ì˜í–¥ë°›ì€ í•¨ìˆ˜ë“¤

```python
# âŒ ë¬¸ì œê°€ ìˆë˜ í•¨ìˆ˜ë“¤
def get_daily_aggregated(data_id, keyword):
    df = st.session_state['cached_trend_df']  # ì˜ëª»ëœ ì°¸ì¡°!
    
def get_weekly_aggregated(data_id, keyword):
    df = st.session_state['cached_trend_df']  # ì˜ëª»ëœ ì°¸ì¡°!
    
def get_pie_aggregated(data_id, keyword):
    df = st.session_state['cached_trend_df']  # ì˜ëª»ëœ ì°¸ì¡°!
    
def precompute_all_keyword_aggregations(data_id):
    df = st.session_state['cached_trend_df']  # ì˜ëª»ëœ ì°¸ì¡°!
```

## âœ… í•´ê²° ë°©ë²•

ëª¨ë“  ì°¨íŠ¸ ë Œë”ë§ í•¨ìˆ˜ì—ì„œ `cached_filtered_df`ë¥¼ ì°¸ì¡°í•˜ë„ë¡ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.

### ìˆ˜ì •ëœ í•¨ìˆ˜ë“¤

#### 1. get_daily_aggregated (ì„ í˜• ì°¨íŠ¸ìš©)

```python
# app.py (Line 144-164)
def get_daily_aggregated(data_id, keyword):
    """
    ì¼ìë³„ ì§‘ê³„ ë°ì´í„°ë¥¼ ìºì‹± (ì„ í˜• ì°¨íŠ¸ìš©)
    data_id: ë°ì´í„° ê³ ìœ  ì‹ë³„ì (ë‚ ì§œë²”ìœ„ + í–‰ìˆ˜)
    """
    # âœ… í•„í„°ë§ëœ ë°ì´í„° ì‚¬ìš©
    if 'cached_filtered_df' not in st.session_state:
        return pd.DataFrame()
    
    df = st.session_state['cached_filtered_df']  # ì ‘ì† ê²½ë¡œ í•„í„° ì ìš©ë¨
    
    if keyword != "ì „ì²´":
        df = df[df['search_keyword'] == keyword]
    
    if df.empty:
        return pd.DataFrame()
    
    # ì§‘ê³„
    daily = df.groupby('search_date')['sessionid'].count().reset_index()
    daily.columns = ['Date', 'Count']
    return daily.sort_values('Date')
```

#### 2. get_weekly_aggregated (ë§‰ëŒ€í˜• ì°¨íŠ¸ìš©)

```python
# app.py (Line 223-251)
def get_weekly_aggregated(data_id, keyword):
    """
    ì£¼ì°¨ë³„/ìš”ì¼ë³„ ì§‘ê³„ ë°ì´í„°ë¥¼ ìºì‹± (ë§‰ëŒ€í˜• ì°¨íŠ¸ìš©)
    """
    # âœ… í•„í„°ë§ëœ ë°ì´í„° ì‚¬ìš©
    if 'cached_filtered_df' not in st.session_state:
        return pd.DataFrame(), pd.DataFrame()
    
    df = st.session_state['cached_filtered_df']  # ì ‘ì† ê²½ë¡œ í•„í„° ì ìš©ë¨
    
    if keyword != "ì „ì²´":
        df = df[df['search_keyword'] == keyword]
    
    if df.empty:
        return pd.DataFrame(), pd.DataFrame()
    
    # ... ì§‘ê³„ ë¡œì§
```

#### 3. get_pie_aggregated (íŒŒì´ ì°¨íŠ¸ìš©)

```python
# app.py (Line 353-368)
@st.cache_data(ttl=3600)
def get_pie_aggregated(data_id, keyword):
    """
    íŒŒì´ ì°¨íŠ¸ìš© ì§‘ê³„ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ìºì‹±
    """
    # âœ… í•„í„°ë§ëœ ë°ì´í„° ì‚¬ìš©
    if 'cached_filtered_df' not in st.session_state:
        return {}, {}, {}, {}
    
    df = st.session_state['cached_filtered_df']  # ì ‘ì† ê²½ë¡œ í•„í„° ì ìš©ë¨
    
    if keyword != "ì „ì²´":
        df = df[df['search_keyword'] == keyword]
    
    if df.empty:
        return {}, {}, {}, {}
    
    # ... ì§‘ê³„ ë¡œì§
```

#### 4. precompute_all_keyword_aggregations

```python
# app.py (Line 166-179)
@st.cache_data(ttl=3600)
def precompute_all_keyword_aggregations(data_id):
    """
    ëª¨ë“  í‚¤ì›Œë“œì˜ ì§‘ê³„ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ê³„ì‚°í•˜ì—¬ ë”•ì…”ë„ˆë¦¬ë¡œ ë°˜í™˜
    í‚¤ì›Œë“œ ì„ íƒ ì‹œ ì¦‰ì‹œ ë°˜í™˜ ê°€ëŠ¥
    """
    # âœ… í•„í„°ë§ëœ ë°ì´í„° ì‚¬ìš©
    if 'cached_filtered_df' not in st.session_state:
        return {}
    
    df = st.session_state['cached_filtered_df']  # ì ‘ì† ê²½ë¡œ í•„í„° ì ìš©ë¨
    
    if df.empty:
        return {}
    
    # ... ì§‘ê³„ ë¡œì§
```

## ğŸ“Š ë°ì´í„° íë¦„ (ìˆ˜ì • í›„)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ë‚ ì§œ í•„í„° ì„ íƒ                                        â”‚
â”‚    â†’ DuckDB ë¡œë“œ                                         â”‚
â”‚    â†’ cached_base_df ì €ì¥ (ì ‘ì† ê²½ë¡œ í•„í„° ì „)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. ì ‘ì† ê²½ë¡œ ì²´í¬ë°•ìŠ¤ ì„ íƒ                               â”‚
â”‚    â†’ cached_base_dfì—ì„œ í•„í„°ë§                          â”‚
â”‚    â†’ cached_filtered_df ì €ì¥ âœ…                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. ì°¨íŠ¸ ë Œë”ë§                                           â”‚
â”‚    â†’ cached_filtered_df ì‚¬ìš© âœ…                         â”‚
â”‚    â†’ ëª¨ë“  ì°¨íŠ¸ì— ì ‘ì† ê²½ë¡œ í•„í„° ë°˜ì˜ë¨                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 1. ì„ í˜• ì°¨íŠ¸ ë°ì´í„° í‘œì‹œ í™•ì¸

```bash
# ì•± ì‹¤í–‰
./venv/bin/streamlit run app.py

# í…ŒìŠ¤íŠ¸ ë‹¨ê³„
1. ë‚ ì§œ ë²”ìœ„ ì„ íƒ (ì˜ˆ: 2026-10-01 ~ 2026-11-30)
2. ì ‘ì† ê²½ë¡œ: ì•±, ëª¨ë°”ì¼ì›¹, PC ëª¨ë‘ ì„ íƒ
3. 'ì£¼ê°„ íŠ¸ë Œë“œ' íƒ­ â†’ í‚¤ì›Œë“œ ì„ íƒ
4. 'ì„ í˜•' ë¼ë””ì˜¤ ë²„íŠ¼ í´ë¦­
5. âœ… ì„ í˜• ì°¨íŠ¸ê°€ ì •ìƒ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸
```

### 2. ì ‘ì† ê²½ë¡œ í•„í„° ë°˜ì˜ í™•ì¸

```bash
# í…ŒìŠ¤íŠ¸ ë‹¨ê³„
1. 'ì£¼ê°„ íŠ¸ë Œë“œ' íƒ­ â†’ 'ì„ í˜•' ì°¨íŠ¸ í‘œì‹œ
2. ì‚¬ì´ë“œë°” â†’ [ì•±] ì²´í¬ë°•ìŠ¤ë§Œ ì„ íƒ (ëª¨ë°”ì¼ì›¹, PC í•´ì œ)
3. âœ… ì„ í˜• ì°¨íŠ¸ ë°ì´í„°ê°€ ì¦‰ì‹œ ë³€ê²½ë˜ëŠ”ì§€ í™•ì¸
4. [ëª¨ë°”ì¼ì›¹] ì¶”ê°€ ì„ íƒ
5. âœ… ì„ í˜• ì°¨íŠ¸ ë°ì´í„°ê°€ ë‹¤ì‹œ ë³€ê²½ë˜ëŠ”ì§€ í™•ì¸
```

### 3. ë§‰ëŒ€í˜• ì°¨íŠ¸ í™•ì¸

```bash
# í…ŒìŠ¤íŠ¸ ë‹¨ê³„
1. 'ì£¼ê°„ íŠ¸ë Œë“œ' íƒ­ â†’ 'ë§‰ëŒ€í˜•' ë¼ë””ì˜¤ ë²„íŠ¼ í´ë¦­
2. âœ… ë§‰ëŒ€í˜• ì°¨íŠ¸ê°€ ì •ìƒ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸
3. ì ‘ì† ê²½ë¡œ ë³€ê²½
4. âœ… ë§‰ëŒ€í˜• ì°¨íŠ¸ ë°ì´í„°ê°€ ì¦‰ì‹œ ë°˜ì˜ë˜ëŠ”ì§€ í™•ì¸
```

### 4. íŒŒì´ ì°¨íŠ¸ í™•ì¸

```bash
# í…ŒìŠ¤íŠ¸ ë‹¨ê³„
1. 'ì£¼ê°„ íŠ¸ë Œë“œ' íƒ­ í•˜ë‹¨ì˜ 4ê°œ íŒŒì´ ì°¨íŠ¸ í™•ì¸
2. âœ… ëª¨ë“  íŒŒì´ ì°¨íŠ¸ê°€ ì •ìƒ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸
3. ì ‘ì† ê²½ë¡œ ë³€ê²½
4. âœ… íŒŒì´ ì°¨íŠ¸ ë°ì´í„°ê°€ ì¦‰ì‹œ ë°˜ì˜ë˜ëŠ”ì§€ í™•ì¸
```

## ğŸ’¡ êµí›ˆ

### 1. ìºì‹œ ë³€ìˆ˜ ë„¤ì´ë°ì˜ ì¤‘ìš”ì„±

```python
# âŒ í˜¼ë€ìŠ¤ëŸ¬ìš´ ë„¤ì´ë°
cached_trend_df  # ì–´ë–¤ í•„í„°ê°€ ì ìš©ëœ ê±´ì§€ ë¶ˆëª…í™•

# âœ… ëª…í™•í•œ ë„¤ì´ë°
cached_base_df      # ë‚ ì§œ í•„í„°ë§Œ ì ìš©
cached_filtered_df  # ëª¨ë“  í•„í„° ì ìš© (ìµœì¢…)
```

### 2. ë°ì´í„° íë¦„ ë¬¸ì„œí™”

ìºì‹œ ì‹œìŠ¤í…œì„ ë„ì…í•  ë•ŒëŠ” **ì–´ë–¤ ìºì‹œê°€ ì–´ë–¤ ë°ì´í„°ë¥¼ ë‹´ê³  ìˆëŠ”ì§€** ëª…í™•íˆ ë¬¸ì„œí™”í•´ì•¼ í•©ë‹ˆë‹¤.

### 3. ì „ì—­ ê²€ìƒ‰ì˜ ì¤‘ìš”ì„±

í•˜ë‚˜ì˜ ë³€ìˆ˜ëª…ì„ ë³€ê²½í•  ë•ŒëŠ” **ì „ì²´ ì½”ë“œë² ì´ìŠ¤ì—ì„œ í•´ë‹¹ ë³€ìˆ˜ë¥¼ ì°¸ì¡°í•˜ëŠ” ëª¨ë“  ê³³**ì„ ì°¾ì•„ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤.

```bash
# ë³€ìˆ˜ ì°¸ì¡° ì°¾ê¸°
grep -n "cached_trend_df" app.py
```

## ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] `get_daily_aggregated` ìˆ˜ì • (ì„ í˜• ì°¨íŠ¸)
- [x] `get_weekly_aggregated` ìˆ˜ì • (ë§‰ëŒ€í˜• ì°¨íŠ¸)
- [x] `get_pie_aggregated` ìˆ˜ì • (íŒŒì´ ì°¨íŠ¸)
- [x] `precompute_all_keyword_aggregations` ìˆ˜ì •
- [x] ë¦°í„° ì˜¤ë¥˜ í™•ì¸
- [x] í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ì‘ì„±

## ğŸ¯ ê²°ê³¼

- âœ… ì„ í˜• ì°¨íŠ¸ ì •ìƒ í‘œì‹œ
- âœ… ì ‘ì† ê²½ë¡œ í•„í„°ê°€ ëª¨ë“  ì°¨íŠ¸ì— ì¦‰ì‹œ ë°˜ì˜
- âœ… ì„±ëŠ¥ ìµœì í™” ìœ ì§€ (ìºì‹± ì‹œìŠ¤í…œ ì •ìƒ ì‘ë™)

---

**ìˆ˜ì •ì¼**: 2026-02-05  
**ë²„ì „**: v6.1 (í•„í„° ìµœì í™” ë²„ê·¸ ìˆ˜ì •)  
**ê´€ë ¨ ë¬¸ì„œ**: PERFORMANCE_FILTER_OPTIMIZATION.md
